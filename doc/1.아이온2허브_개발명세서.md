# AION2 HUB 개발 설계서 v0.2

작성일: 2026-01-28

문서 목적: **Codex CLI로 구현 가능한 수준**까지, 모듈 구조로 확장 가능한 웹 기반 동반자 허브의 설계를 정의합니다.

> 2026-01-28 결정: **Legion/Discord Bot은 스코프에서 제외**합니다.

---

## 1. 목표 & Non-goal

### 1.1 목표

1. **로컬-퍼스트 숙제/기록 관리(Planner)** 로 일일/주간 루틴의 인지 부하 감소
2. **공식 공지/업데이트 노트(diff 중심)(Notices)** 로 패치 대응 비용 감소

### 1.2 절대 금지(Non-goal)

운영정책 리스크 회피를 위해 아래는 요구사항에서 명시적으로 배제합니다.

- 게임 클라이언트(메모리/프로세스/패킷) 접근, 후킹/변조, 자동 입력/매크로
- 계정/보호조치 우회, VPN 우회, 하드웨어 차단 회피류
- 정상 이용자가 할 수 없는 행위를 가능하게 하는 기능

---

## 2. 제품 정의

- 제품명: **AION2 HUB** — 안전한 올인원 동반자 허브(Planner + Notices diff)
- MVP: Core(허브 프레임) + Planner + Notices (+ Links)

---

## 3. 시스템 아키텍처

```txt
Web (Next.js)
- Dashboard / Settings / Characters(local)
- Module Pages (/m/[moduleId]/[pageId])

API (Fastify)
- notices endpoints

Worker (BullMQ)
- notices fetch/snapshot/diff pipeline

Postgres (Prisma)
- NoticeItem/NoticeSnapshot/NoticeDiff

Redis
- worker queue
```

---

## 4. 모듈 구조

- `packages/core`: 모듈 레지스트리/라우트 리졸버
- `packages/modules/planner`: 로컬-퍼스트 플래너(Dexie/IndexedDB)
- `packages/modules/notices`: 공지/업데이트 피드 + diff 뷰어(UI)
- `packages/modules/links`: 공식 링크 허브

---

## 5. 데이터/저장 전략

- Planner: IndexedDB(Dexie)
  - templates/completions/durations/chargeUses/settings
- Hub 설정(모듈 토글 등): localStorage
- Notices: 서버 저장(Postgres)
  - 목록(NoticeItem) + 스냅샷(NoticeSnapshot) + diff(NoticeDiff)

---

## 6. 다음 구현(권장)

- Notices 수집 파이프라인(Worker) → API → Web UI(Feed/Detail/Diff)
- 이후: WebPush 알림(옵션, 우선 stub)
